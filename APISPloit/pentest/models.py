from django.db import models

# Create your models here.
class Scans(models.Model):
    url = models.TextField()
    start_time = models.DateTimeField(auto_now_add=True)
    end_time = models.DateTimeField(null=True)
    request_method = models.CharField(max_length=10)

class Endpoints(models.Model):
    path = models.CharField(max_length=100)
    status_code = models.CharField(max_length=4)
    scan = models.ForeignKey(Scans, on_delete=models.CASCADE, related_name="endpoints")

class Tests(models.Model):
    test_name = models.CharField(max_length=60)
    start_time = models.DateTimeField(auto_now_add=True)
    end_time = models.DateTimeField(null=True)
    scan = models.ForeignKey(Scans, on_delete=models.CASCADE, related_name="tests")

class Payloads(models.Model):
    payload_string = models.TextField(blank=True)
    request = models.TextField(null=True)
    response = models.TextField(null=True)
    test = models.ForeignKey(Tests, on_delete=models.CASCADE, related_name="payloads")