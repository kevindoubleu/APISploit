{% extends 'layouts/base.html' %}

{% block title %}
New Scan
{% endblock %}

{% block content %}
<!-- Page Heading -->
<!-- <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800 center">Dashboard</h1>
    <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i
            class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
</div> -->

<div class="form-group">
    <label for="url" style="font-size:17px;">URL : </label>
    <input type="text" class="form-control" id="url" placeholder="Enter URL" name="url">
</div>

<div class="form-group">
    <label for="method" style="font-size:17px;">Request Method : </label>
    <select class="form-control" name="method" id="method">
        <option value="get" selected>GET</option>
        <option value="post">POST</option>
        <option value="put">PUT</option>
        <option value="delete">DELETE</option>
        <option value="patch">PATCH</option>
    </select>
</div>

<div class="form-group">
    <label for="headers" style="font-size:17px;">Request Headers (In JSON Format) : </label>
    <textarea class="form-control" name="headers" id="headers" rows="3" placeholder='{"Origin" : "evil.com", "Content-Type" : "application/json"}'></textarea>
</div>

<div class="form-group" id="dataFormatDiv"  style="display: none;">
    <label for="Data Format" style="font-size:17px;">Data Format : </label><br>
    <div class="btn-group" data-toggle="buttons">
        <label class="btn btn-success">
            <input type="radio" name="dataFormat" id="json" value="JSON" style="display: none;" checked>JSON
        </label>
        <label class="btn btn-danger">
            <input type="radio" name="dataFormat" value="XML" style="display: none;" id="xml">XML
        </label>
    </div>
</div>

<div class="form-group">
    <label for="Vulnerabilities" style="font-size:17px;">Select vulnerabilities you want to scan : </label><br>
    <div class="form-check form-check-inline mt-2">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox1" value="IDOR" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox1">IDOR</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox2" value="JWT" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox2">JWT</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox3" value="Weak Session Management" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox3">Weak Session Management</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox4" value="Rate Limit" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox4">Rate Limit</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox5" value="CORS" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox5">CORS Misconfiguration</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox6" value="SQLI" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox6">SQLI</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox7" value="NOSQLI" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox7">NOSQLI</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox8" value="Weak SSL" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox8">SSL Configuration</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox9" value="Testing Cookie Attributes" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox9">Cookie Attributes</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox10" value="XXE" style="width:20px; height:20px;" disabled>
        <label class="form-check-label" for="inlineCheckbox10">XXE</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox11" value="Brute Endpoint" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox11">Find Secret Endpoints</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox12" value="Banner Grabbing" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox12">Banner Grabbing</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" name="vulns" type="checkbox" id="inlineCheckbox13" value="GraphQL" style="width:20px; height:20px;">
        <label class="form-check-label" for="inlineCheckbox13">GraphQL</label>
    </div>
</div>
<div class="form-group" id="statusCodesInput" style="display: none;">
    <label for="statuscodes" style="font-size:17px;">Include status codes (Separated by commas. Default status code is 200) : </label>
    <input type="text" class="form-control" id="statusCodes" placeholder="200,403" name="statusCodes">
</div>
<div class="form-group" id="payloadType" style="display: none;">
    <div class="form-group">
    <label for="payloadtype" style="font-size:17px;">Payload Type : </label>
        <select class="form-control" name="payloadOptions" id="payloadOptions">
            <option value="wordlist" selected>Custom wordlist</option>
            <option value="numbers">Numbers</option>
        </select>
    </div>
</div>

<div class="form-group" id="wordlist" style="display: none;">
    <label for="Wordlist" style="font-size:17px;">Wordlist : </label>
    <textarea class="form-control" name="wordlist" rows="8" id="wordlistVal"></textarea>
</div>

<div class="form-group" id="numberIterator" style="display: none;">
    <label for="url" style="font-size:17px;">Number Range: </label>
    <div class="form-row">
        <div class="col-1">
        <input type="text" class="form-control" placeholder="From" id="fromVal">
        </div>
        <div class="col-1">
        <input type="text" class="form-control" placeholder="To" id="toVal">
        </div>
        <div class="col-1">
        <input type="text" class="form-control" placeholder="Step" id="stepVal">
        </div>
    </div>
</div>
                    
<div class="form-group" id="bodyDiv" style="display: none;">
    <label for="Request Body" style="font-size:17px;">Request Body : </label>
    <textarea class="form-control" name="requestBody" rows="10" id="requestBody"></textarea>
</div>

<div class="form-group">
</div>

<p style="font-size:17px;">Notes:</p>
<ul style="padding:10;"> 
    <li style="font-size:17px;">For scanning IDOR, please define the injection point by using <b>~</b> marker on URL input or Request Body</li>
    <li style="font-size:17px;">For scanning NOSQL Injection, please define the injection point by using <b>@</b> marker on URL input or Request Body</li>
    <li style="font-size:17px;">For scanning SQL Injection, please define the injection point by using <b>*</b> marker on URL input or Request Body</li>
    <li style="font-size:17px;">For scanning JWT vulnerabilties, please define your JWT Token on Request Headers with the following format : {"Authorization" : "Bearer <b>Your Token</b>"}</li>
    <li style="font-size:17px;">If you don't want APISPloit to process your injection marker, please escape it by using <b>\</b>. For example : {"username" : "user123<b>\*</b>"}</li>
</ul>
<button type="submit" name="submit" id="submit" class="btn-lg btn-primary mt-2 mb-4">Submit</button>
{% endblock %}

{% block endscripts %}
<!-- Define IP Address -->
<script>const api_url = "{{url}}"; </script>
<!-- Sweetalert -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
{% load static %}
<script src="{% static 'pentest/js/input-validation.js'%}"></script>
{% endblock %}
