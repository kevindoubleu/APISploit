# Generated by Django 2.2.22 on 2021-09-13 09:21

from django.db import migrations
from django.utils import timezone

def add_scans(apps, schema_editor):
    Scan = apps.get_model('pentest', 'Scan')
    Scan(url="google.com", request_method='POST').save()

def add_tests(apps, schema_editor):
    Scan = apps.get_model('pentest', 'Scan')
    Test = apps.get_model('pentest', 'Test')
    s = Scan.objects.get(pk=1)
    Test(test_name='XSS', start_time=timezone.now(), end_time=timezone.now(), scan=s).save()
    Test(test_name='SQLI', start_time=timezone.now(), scan=s).save()
    Test(test_name='CMDI', scan=s).save()

def add_payloads(apps, schema_editor):
    Test = apps.get_model('pentest', 'Test')
    Payload = apps.get_model('pentest', 'Payload')
    t1 = Test.objects.get(pk=1)
    t2 = Test.objects.get(pk=2)
    Payload(payload_string="<script>alert(1)</script>", test=t1).save()
    Payload(payload_string="javascript:alert(1)", test=t1).save()
    Payload(payload_string="'or 1", test=t2).save()
    Payload(payload_string="'or 1 limit 1", test=t2).save()

class Migration(migrations.Migration):

    dependencies = [
        ('pentest', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(add_scans),
        migrations.RunPython(add_tests),
        migrations.RunPython(add_payloads),
    ]
